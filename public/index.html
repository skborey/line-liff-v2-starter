<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loading ...</title>
</head>
<body>
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>
    <script>
        window.onload = function () {

            var endpoint = "https://tracechain.gatewayserviceth.com/#/";
            var liffId = "1654048483-NG5eBoKW"

            liff
                .init({
                    liffId: liffId
                })
                .then(() => {
                    if (liff.isInClient()) {
                        // start to use LIFF's api
                        initializeApp();
                    }
                })
                .catch((err) => {
                    console.log(err)
                });

            function initializeApp() {
                liff.getProfile().then(function (profile) {

                    var url = endpoint + '?userID=' + profile.userId
                        + '&userName=' + profile.displayName
                        + '&province=Bangkok'

                    const queryString = decodeURIComponent(window.location.search).replace("?liff.state=", "");
                    const params = new URLSearchParams(queryString);
                    const menu = params.get('menu');
                    url += '&menu=' + ((menu != null && menu != '') ? menu : 'covidTracker');

                    // liff.closeWindow();
                    // liff.openWindow({ url: url });
                    window.location = url;
                }).catch(function (error) {
                    // console.log('Error getting profile: ' + error);
                });
            }
        }
    </script>
</body>

</html>